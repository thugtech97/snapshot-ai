<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>SnapshotAI</title>
  <style>
    :root {
      --accent: #0b84ff;
      --bg: #f7f7f8;
      --muted: #666;
      --bubble-user: #0b84ff;
      --bubble-assistant: #f0f4f8;
    }

    html,body {
      margin: 0;
      padding: 12px;
      width: 480px;
      height: 600px;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
      background: var(--bg);
      box-sizing: border-box;
      overflow: hidden;
    }

    h3 {
      margin: 0 0 8px 0;
      font-size: 18px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    h3 small { color: var(--muted); font-size:12px; font-weight:600; }

    .top-row { display:flex; gap:8px; margin-bottom:8px; }
    button {
      padding:8px 10px;
      border-radius:8px;
      border:0;
      background:var(--accent);
      color:#fff;
      font-weight:600;
      cursor:pointer;
    }
    .ghost {
      background:transparent;
      color:var(--accent);
      border:1px solid rgba(11,132,255,0.14);
    }

    #canvas {
      display:block;
      margin-top:10px;
      max-width:100%;
      border-radius:6px;
      border:1px solid rgba(0,0,0,0.06);
    }

    .hint { margin-top:8px; color:var(--muted); font-size:13px; }
    
    .chat-wrapper {
      margin-top:10px;
      height: 220px;
      background: transparent;
      overflow-y: auto;
      padding-right: 6px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .message {
      max-width:82%;
      padding:10px 12px;
      border-radius:14px;
      font-size:14px;
      line-height:1.35;
      word-break:break-word;
      box-shadow: 0 1px 0 rgba(0,0,0,0.02);
    }
    .message.user {
      margin-left:auto;
      background: var(--bubble-user);
      color:#fff;
      border-bottom-right-radius:4px;
    }
    .message.assistant {
      margin-right:auto;
      background: var(--bubble-assistant);
      color:#000;
      border-bottom-left-radius:4px;
    }

    .composer {
      margin-top:8px;
      display:flex;
      gap:8px;
      align-items:flex-end;
    }
    .composer textarea {
      flex:1;
      min-height:46px;
      max-height:120px;
      resize: vertical;
      padding:10px;
      border-radius:10px;
      border:1px solid #e2e2e2;
      font-size:14px;
      font-family:inherit;
    }
    .controls { display:flex; gap:8px; flex-direction:column; align-items:flex-end; }
    #loading { display:none; text-align:center; font-size:13px; color:var(--muted); }

    .row { display:flex; gap:8px; }
  </style>
</head>
<body>
  <h3>
    SnapshotAI
    <small>SourceU</small>
  </h3>

  <div class="top-row">
    <button id="capture">Take Snapshot</button>
    <button id="clear" class="ghost">Clear</button>
    <button id="crop" class="ghost">Crop</button>
    <button id="download" class="ghost">Get insights</button>
  </div>

  <canvas id="canvas" width="300" height="180" aria-label="Snapshot preview"></canvas>

  <div class="hint">After cropping you can type a question about the snapshot or click "Get insights" for a quick analysis.</div>

  <div class="chat-wrapper" id="chat" aria-live="polite"></div>

  <div class="composer" role="group" aria-label="Chat composer">
    <textarea id="prompt" placeholder="Ask about the snapshot or type a prompt..." aria-label="Prompt input"></textarea>
    <div class="controls">
      <button id="send">Send</button>
      <div id="loading">Sendingâ€¦</div>
    </div>
  </div>

  <div id="result" style="display:none;"></div>

  <script src="popup.js"></script>
</body>
</html>
